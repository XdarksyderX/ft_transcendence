<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark ctm-navbar p-1">
        <span class="navbar-brand ms-2" id="pong">PONG</span>
        <div class="d-flex ms-auto align-items-center">
            <a class="nav-link ctm-link" href="index.html">Home</a>
        </div>
    </nav>

    <main class="container mt-5 blinking-neon-frame">
        <div id="profile-card" class="ctm-card position-relative">
            <h2 class="text-center ctm-text-title">My profile</h2>
            <div class="d-flex justify-content-center">
                <div class="d-flex flex-column align-items-center">
                    <img src="https://cdn.icon-icons.com/icons2/1378/PNG/512/avatardefault_92824.png" alt="profile picture" class="profile-picture mb-2">
                    <h3 id="username" class="ctm-text-light"></h3>
                    <h5 id="registration" class="ctm-text-light"></h5>
                    <h5 id="total-friends" class="ctm-text-light"></h5>
                    <h5 id="total-matches" class="ctm-text-light"></h5>
                    <div class="mt-2">
                        <button id="edit-profile" class="btn ctm-btn">Edit profile</button>
                        <button id="save-changes" class="btn ctm-btn d-none">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const user = {
            username: 'erivero-',
            registration: '3/11/24',
            totalFriends: 3,
            totalMatches: 42
        };

        const elements = {
            username: document.getElementById('username'),
            registration: document.getElementById('registration'),
            totalFriends: document.getElementById('total-friends'),
            totalMatches: document.getElementById('total-matches'),
            editProfile: document.getElementById('edit-profile'),
            saveChanges: document.getElementById('save-changes'),
            profileCard: document.getElementById('profile-card')
        };

        function renderUserData() {
            elements.username.textContent = user.username;
            elements.registration.textContent = `Registered on: ${user.registration}`;
            elements.totalFriends.textContent = `Friends: ${user.totalFriends}`;
            elements.totalMatches.textContent = `Total matches: ${user.totalMatches}`;
        }

        function toggleEditMode(isEditing) {
            elements.editProfile.classList.toggle('d-none', isEditing);
            elements.saveChanges.classList.toggle('d-none', !isEditing);
            
            if (isEditing) {
                elements.username.innerHTML = `
                    <div class="d-flex justify-content-center">New username:</div>
                    <input type="text" class="ctm-text-dark text-center" value="${user.username}">
                `;
                const cancelBtn = document.createElement('button');
                cancelBtn.textContent = 'x';
                cancelBtn.className = 'btn ctm-text-title position-absolute top-0 end-0 m-2';
                cancelBtn.addEventListener('click', () => toggleEditMode(false));
                elements.profileCard.appendChild(cancelBtn);
            } else {
                renderUserData();
                const cancelBtn = elements.profileCard.querySelector('.ctm-text-title');
                if (cancelBtn) cancelBtn.remove();
            }
        }

        elements.editProfile.addEventListener('click', () => toggleEditMode(true));

        elements.saveChanges.addEventListener('click', () => {
            user.username = elements.username.querySelector('input').value;
            toggleEditMode(false);
        });

        renderUserData();
    </script>

    <script src="neon.js"></script>
    <script src="login.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>