<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">    
  <link rel="stylesheet" href="../../styles.css">
  <title>Tournament Bracket</title>
  <style>
 body {
		font-family: 'VT323', monospace;
		margin: 20px;
      	padding: 0;
        overflow-y: auto;

    }

    .bracket {
      display: flex;
      flex-direction: row;
      justify-content: space-around;
      align-items: stretch; /* Ensure all rounds stretch to the same height */
    }

    .round {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0 20px;
      flex: 1; /* Ensure each round takes equal space */
	  position: relative;
	  justify-content: center;
    }

	.pair-round {
		/* background: linear-gradient(to top, var(--medium), var(--dark)); */
		/* background-color: #2d124074; */
		border-left: 1px solid var(--light);
		border-right: 1px solid var(--light);
		border-radius: 5px;
	}

    .match {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-around;
      width: 120px;
      height: 60px;
      border: 2px solid var(--light);
	  box-shadow: 0 0 5px var(--light);

      margin: 10px 0;
      border-radius: 5px;
      /* background-color: #fff; */
      cursor: pointer;
    }


	  .match.pending {
      border-color: var(--lorange);
      box-shadow: 0 0 5px var(--lorange);

    }

    .winner {
		color: var(--accent);
		text-shadow: 0 0 2px var(--light);
    }

    .round-title {
      font-weight: bold;
      margin-bottom: 10px;
	  position: relative;
    }
	
	.match-divider {
    border-top: 1px solid var(--light);
	width: 75%;
	}
  .ctm-card {
    box-shadow: 0 0 10px #00F56A, 0 0 20px #00F56A, 0 0 30px #00F56A, 0 0 40px #00F56Acc;
  }
  </style>
</head>
<body>
  <h1 class="ctm-text-title text-center mb-5">Ongoing Tournaments</h1>
  <div id="tournaments-container"></div>

  <script>
    // Phase 1: Preliminary rounds

/* Im asumming I have a json like this:
{
  "tournamentName": "Spring Championship 2025",
  "phases": [
    {
      "phase": "Phase 1",
      "matches": [
        {
          "matchId": 1,
          "teams": ["Team A", "Team B"],
          "status": "pending",
          "winner": null
        },
        {
          "matchId": 2,
          "teams": ["Team C", "Team D"],
          "status": "completed",
          "winner": "Team C"
        },
        {
          "matchId": 3,
          "teams": ["Team E", "Team F"],
          "status": "pending",
          "winner": null
        },
        {
          "matchId": 4,
          "teams": ["Team G", "Team H"],
          "status": "completed",
          "winner": "Team G"
        }
      ]
    },
    {
      "phase": "Phase 2",
      "matches": [
        {
          "matchId": 5,
          "teams": ["Team C", "Team G"],
          "status": "pending",
          "winner": null
        },
        {
          "matchId": 6,
          "teams": ["Team A", "Team F"],
          "status": "pending",
          "winner": null
        }
      ]
    },
    {
      "phase": "Phase 3",
      "matches": [
        {
          "matchId": 7,
          "teams": ["Winner of Match 5", "Winner of Match 6"],
          "status": "pending",
          "winner": null
        }
      ]
    }
  ]
}
 */

 const tournament1 = {
  tournamentName: "Copa champiñón",
  phases: [
    {
      number: 1,
      matches: [
        {
          matchId: 1,
          teams: ["Team A", "Team B"],
          status: "completed",
          winner: "Team A"
        },
        {
          matchId: 2,
          teams: ["Team C", "Team D"],
          status: "completed",
          winner: "Team C"
        },
        {
          matchId: 3,
          teams: ["Team E", "Team F"],
          status: "completed",
          winner: "Team F"
        },
        {
          matchId: 4,
          teams: ["Team G", "Team H"],
          status: "completed",
          winner: "Team G"
        }
      ]
    },
    {
      number: 2,
      matches: [
        {
          matchId: 5,
          teams: ["Team C", "Team G"],
          status: "completed",
          winner: "Team G"
        },
        {
          matchId: 6,
          teams: ["Team A", "Team F"],
          status: "completed",
          winner: "Team A"
        }
      ]
    },
    {
      number: 3,
      matches: [
        {
          matchId: 7,
          teams: ["Team G", "Team A"],
          status: "completed",
          winner: "Team A"
        }
      ]
    }
  ]
};

const tournament2 = {
  tournamentName: "Copa cebollino",
  phases: [
    {
      number: 1,
      matches: [
        {
          matchId: 1,
          teams: ["Team A", "Team B"],
          status: "pending",
          winner: null
        },
        {
          matchId: 2,
          teams: ["Team C", "Team D"],
          status: "completed",
          winner: "Team C"
        },
        {
          matchId: 3,
          teams: ["Team E", "Team F"],
          status: "pending",
          winner: null
        },
        {
          matchId: 4,
          teams: ["Team G", "Team H"],
          status: "completed",
          winner: "Team G"
        }
      ]
    },
    {
      number: 2,
      matches: [
        {
          matchId: 5,
          teams: ["Team C", "Team G"],
          status: "pending",
          winner: null
        },
        {
          matchId: 6,
          teams: ["???", "???"],
          status: "pending",
          winner: null
        }
      ]
    },
    {
      number: 3,
      matches: [
        {
          matchId: 7,
          teams: ["???", "???"],
          status: "pending",
          winner: null
        }
      ]
    }
  ]
};

const tournaments = [tournament1, tournament2];


    function renderAllTournaments() {
      const container = document.getElementById('tournaments-container');
      tournaments.forEach(oneTournament => {
        const tournament = generateTournament(oneTournament);
        container.appendChild(tournament);
      });
    }

    function generateTournament(tournament) {
      const container = document.createElement('div');
      container.classList.add("ctm-card");
      container.classList.add("mt-5");
      const bracket = generateBracket(tournament);
      container.innerHTML = `
        <div class="text-center ctm-text-title mb-3">${tournament.tournamentName}</div>
        ${bracket.outerHTML}
      `;
      return container;
    }

    function generateBracket(tournament) {
      const bracket = document.createElement('div');
      bracket.classList.add('bracket', 'ctm-text-light');
      tournament.phases.forEach(phase => {
        const round = generateRound(phase);
        bracket.appendChild(round);
      });
      return bracket;
    }

    function generateRound(phase) {
      const round = document.createElement('div');
      round.classList.add('round');
      const matches = generateMatches(phase.matches);
      round.innerHTML = `
        <div class="mt-2 ${phase.number === 1 ? '' : 'position-absolute top-0'}">Phase ${phase.number}</div>
        ${matches}
      `;
      return round;
    }

    function generateMatches(matches) {
      return matches.map(match => `
        <div class="match ${match.status === 'pending' ? 'pending' : ''}"">
          <div class="${match.winner === match.teams[0] ? 'winner' : ''}">${match.teams[0]}</div>
					<div class="match-divider"></div>
          <div class="${match.winner === match.teams[1] ? 'winner' : ''}">${match.teams[1]}</div>
        </div>
      `).join('');
    }

  document.addEventListener('DOMContentLoaded', renderAllTournaments);

// 
  </script>
</body>
</html>
